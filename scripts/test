#!/usr/bin/env bash
set -euo pipefail

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

function print_usage() {
  echo "Usage: scripts/test [--skip-private-docker-registry-tests] [-- [ginkgo_args]]"
}

while [ ! $# -eq 0 ]; do
  case "$1" in
    --skip-private-docker-registry-tests)
        export SKIP_PRIVATE_DOCKER_REGISTRY_TESTS=true
      ;;

    --)
      shift
      break
      ;;

    --help | -h)
      print_usage
      exit 0
      ;;
  esac
  shift
done

(
  cd "$( dirname "$DIR" )"
  ginkgo -r -keepGoing -failOnPending -randomizeAllSpecs -randomizeSuites -p "$@"
)
